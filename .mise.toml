# mise configuration for dotfiles repo
# Automatically installs pre-commit hooks on directory entry

[settings]
experimental = true
pipx.uvx = true

[tools]
prek = "0.2"       # renovate: datasource=github-releases depName=j178/prek
ansible = "13.1"   # renovate: datasource=github-releases depName=ansible/ansible
chezmoi = "2.69.3" # renovate: datasource=github-releases depName=twpayne/chezmoi
pipx = "latest"

[tasks.install-hooks]
description = "Install pre-commit hooks using prek"
run = """
#!/bin/sh
if command -v prek >/dev/null 2>&1; then
  prek install --hook-type commit-msg
  prek install
  echo "prek hooks installed"
else
  echo "prek not available yet - mise will install it automatically"
fi
"""

[tasks.setup]
description = "Run initial setup"
depends = ["install-hooks"]

[hooks]
enter = "mise run install-hooks"
